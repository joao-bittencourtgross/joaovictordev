jQuery(function($) {
    //CLICK FUNCTIONS
    //######################################################################################################################################################
    //------------------------------------------------------------------------------------------------------------------------------------------------------
    $("#mainmenu>ul>li>a").click(function() {
        $(this).parent().parent().find('ul').slideUp();
        var p = $(this).parent()
        var ul = $(this).parent().find('ul');
        if (ul.css('display') == 'none')
            ul.slideDown();
        else
            ul.slideUp();
    });

    //FILE FUNCTIONS
    //######################################################################################################################################################
    //------------------------------------------------------------------------------------------------------------------------------------------------------
    $("input[type=file]").change(function(e) {

        var $this = $(this);
        var exts = $(this).attr('data-extensions') ? $(this).attr('data-extensions').toLowerCase().split(',') : null;
        var maxsize = $(this).attr('data-maxsize') ? $(this).attr('data-maxsize') : 10240;
        var files = $(this)[0].files;

        for (var i = 0; i < files.length; i++) {

            var name = files[i].name;
            var ext = files[i].name.toLowerCase().split('.').pop();
            var size = Math.floor(files[i].size / 1024);

            if (exts && $.inArray(ext, exts) < 0) {
                $this.val('');
                alert('Selecione somente arquivos com as seguintes extensÃµes: "' + exts + '"');
                e.stopImmediatePropagation();
                return false;
            }

            if (maxsize && size >= maxsize) {
                $this.val('');
                alert('Algum dos arquivos selecionados ultrapassa o limite de ' + maxsize + 'KB');
                e.stopImmediatePropagation();
                return false;
            }
        }
    });
    //------------------------------------------------------------------------------------------------------------------------------------------------------
    //TIMER FUNCTIONS
    //######################################################################################################################################################
    //------------------------------------------------------------------------------------------------------------------------------------------------------
    $("[data-delay-hide]").each(function(){
        var delay=$(this).attr('data-delay-hide')*1000;
        $(this).delay(delay).fadeOut();
    });
    //------------------------------------------------------------------------------------------------------------------------------------------------------
    //PLUGINS
    //######################################################################################################################################################
    //------------------------------------------------------------------------------------------------------------------------------------------------------
    var media={
        crop:function(p,w,h){
            return '/media/crop/'+w+'x'+h+'/'+p;
        },
        resize:function(p,w,h){
            return '/media/resize/'+w+'x'+h+'/'+p;
        }
    }
    //------------------------------------------------------------------------------------------------------------------------------------------------------
    //SORTABLE
    //######################################################################################################################################################
    //------------------------------------------------------------------------------------------------------------------------------------------------------
    $(".sortable").sortable();
});